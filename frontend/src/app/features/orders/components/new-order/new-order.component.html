<div class="new-order-container">
  <h2>Novo Pedido</h2>
  
  <form [formGroup]="orderForm">
    <div class="customer-info">
      <h3>Dados do Cliente</h3>
      <mat-form-field>
        <input matInput placeholder="Nome do Cliente" formControlName="customerName">
        <mat-error *ngIf="orderForm.get('customerName')?.hasError('required')">
          Nome é obrigatório
        </mat-error>
      </mat-form-field>

      <mat-form-field>
        <input matInput placeholder="Número da Casa" formControlName="houseNumber">
        <mat-error *ngIf="orderForm.get('houseNumber')?.hasError('required')">
          Número da casa é obrigatório
        </mat-error>
      </mat-form-field>

      <mat-form-field>
        <input matInput placeholder="Telefone (opcional)" formControlName="phone">
      </mat-form-field>
    </div>

    <div class="agendamento-section">
      <h2>Agendamento do Pedido</h2>
      <div class="agendamento-toggle">
        <mat-slide-toggle [formControlName]="'isScheduled'">
          Agendar horário específico para preparo
        </mat-slide-toggle>
      </div>

      <div class="agendamento-times" *ngIf="orderForm.get('isScheduled')?.value">
        <mat-form-field>
          <mat-label>Horário de Preparo</mat-label>
          <input matInput type="time" [formControlName]="'preparationTime'" [min]="minDeliveryTime">
          <mat-error *ngIf="orderForm.get('preparationTime')?.hasError('required')">
            Horário de preparo é obrigatório
          </mat-error>
        </mat-form-field>
      </div>
    </div>

    <div class="pizzas-section">
      <h2>Pizzas do Pedido</h2>
      <button mat-raised-button color="primary" (click)="openPizzaSelection()">
        <mat-icon>add</mat-icon>
        Adicionar Pizza
      </button>

      <div class="pizzas-list">
        <mat-card *ngFor="let pizza of selectedPizzas; let i = index">
          <mat-card-content>
            <div class="pizza-info">
              <span class="pizza-flavor">{{formatPizzaFlavors(pizza)}}</span>
              <span class="pizza-quantity">Quantidade: {{pizza.quantity}}</span>
            </div>
            <button mat-icon-button color="warn" (click)="removePizza(i)">
              <mat-icon>delete</mat-icon>
            </button>
          </mat-card-content>
        </mat-card>
      </div>
    </div>

    <div class="total-section" *ngIf="selectedPizzas.length > 0">
      <h3>Total do Pedido</h3>
      <p class="total-price">R$ {{ calculateTotal().toFixed(2) }}</p>
    </div>

    <div class="actions">
      <button mat-stroked-button (click)="cancel()">Cancelar</button>
      <button mat-raised-button color="primary" 
              [disabled]="!isOrderValid()"
              (click)="finishOrder()">
        Finalizar Pedido
      </button>
    </div>
  </form>
</div> 